{"ast":null,"code":"import axios from 'axios';\nimport _ from 'lodash'; // import config from './config';\n\nconst instance = axios.create({\n  baseURL: process.env.REACT_APP_BACKEND_URL // withCredentials: true\n\n}); // const createError = (httpStatusCode, statusCode, errorMessage, problems, errorCode = '') => {\n//     const error = new Error();\n//     error.httpStatusCode = httpStatusCode;\n//     error.statusCode = statusCode;\n//     error.errorMessage = errorMessage;\n//     error.problems = problems;\n//     error.errorCode = errorCode + \"\";\n//     return error;\n// };\n// export const isSuccessStatusCode = (s) => {\n//     // May be string or number\n//     const statusType = typeof s;\n//     return (statusType === 'number' && s === 0) || (statusType === 'string' && s.toUpperCase() === 'OK');\n// };\n\ninstance.interceptors.response.use(response => {\n  // Thrown error for request with OK status code\n  const {\n    data\n  } = response;\n\n  if (data.hasOwnProperty('s') && !isSuccessStatusCode(data['s']) && data.hasOwnProperty('errmsg')) {\n    return Promise.reject(createError(response.status, data['s'], data['errmsg'], null, data['errcode'] ? data['errcode'] : \"\"));\n  } // Return direct data to callback\n\n\n  if (data.hasOwnProperty('s') && data.hasOwnProperty('d')) {\n    return data['d'];\n  } // Handle special case\n\n\n  if (data.hasOwnProperty('s') && _.keys(data).length === 1) {\n    return null;\n  }\n\n  return response.data;\n}, error => {\n  const {\n    response\n  } = error;\n\n  if (response == null) {\n    return Promise.reject(error);\n  }\n\n  const {\n    data\n  } = response;\n\n  if (data.hasOwnProperty('s') && data.hasOwnProperty('errmsg')) {\n    return Promise.reject(createError(response.status, data['s'], data['errmsg']));\n  }\n\n  if (data.hasOwnProperty('code') && data.hasOwnProperty('message')) {\n    return Promise.reject(createError(response.status, data['code'], data['message'], data['problems']));\n  }\n\n  return Promise.reject(createError(response.status));\n});\nexport default instance;","map":{"version":3,"sources":["D:/NienLuan/project/REACTJS/src/axios.js"],"names":["axios","_","instance","create","baseURL","process","env","REACT_APP_BACKEND_URL","interceptors","response","use","data","hasOwnProperty","isSuccessStatusCode","Promise","reject","createError","status","keys","length","error"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,CAAP,MAAc,QAAd,C,CACA;;AAEA,MAAMC,QAAQ,GAAGF,KAAK,CAACG,MAAN,CAAa;AAC1BC,EAAAA,OAAO,EAAEC,OAAO,CAACC,GAAR,CAAYC,qBADK,CAE1B;;AAF0B,CAAb,CAAjB,C,CAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEAL,QAAQ,CAACM,YAAT,CAAsBC,QAAtB,CAA+BC,GAA/B,CACKD,QAAD,IAAc;AACV;AACA,QAAM;AAAEE,IAAAA;AAAF,MAAWF,QAAjB;;AACA,MAAIE,IAAI,CAACC,cAAL,CAAoB,GAApB,KAA4B,CAACC,mBAAmB,CAACF,IAAI,CAAC,GAAD,CAAL,CAAhD,IAA+DA,IAAI,CAACC,cAAL,CAAoB,QAApB,CAAnE,EAAkG;AAC9F,WAAOE,OAAO,CAACC,MAAR,CAAeC,WAAW,CAACP,QAAQ,CAACQ,MAAV,EAAkBN,IAAI,CAAC,GAAD,CAAtB,EAA6BA,IAAI,CAAC,QAAD,CAAjC,EAA6C,IAA7C,EAAmDA,IAAI,CAAC,SAAD,CAAJ,GAAkBA,IAAI,CAAC,SAAD,CAAtB,GAAoC,EAAvF,CAA1B,CAAP;AACH,GALS,CAMV;;;AACA,MAAIA,IAAI,CAACC,cAAL,CAAoB,GAApB,KAA4BD,IAAI,CAACC,cAAL,CAAoB,GAApB,CAAhC,EAA0D;AACtD,WAAOD,IAAI,CAAC,GAAD,CAAX;AACH,GATS,CAUV;;;AACA,MAAIA,IAAI,CAACC,cAAL,CAAoB,GAApB,KAA4BX,CAAC,CAACiB,IAAF,CAAOP,IAAP,EAAaQ,MAAb,KAAwB,CAAxD,EAA2D;AACvD,WAAO,IAAP;AACH;;AACD,SAAOV,QAAQ,CAACE,IAAhB;AACH,CAhBL,EAiBKS,KAAD,IAAW;AACP,QAAM;AAAEX,IAAAA;AAAF,MAAeW,KAArB;;AACA,MAAIX,QAAQ,IAAI,IAAhB,EAAsB;AAClB,WAAOK,OAAO,CAACC,MAAR,CAAeK,KAAf,CAAP;AACH;;AAED,QAAM;AAAET,IAAAA;AAAF,MAAWF,QAAjB;;AAEA,MAAIE,IAAI,CAACC,cAAL,CAAoB,GAApB,KAA4BD,IAAI,CAACC,cAAL,CAAoB,QAApB,CAAhC,EAA+D;AAC3D,WAAOE,OAAO,CAACC,MAAR,CAAeC,WAAW,CAACP,QAAQ,CAACQ,MAAV,EAAkBN,IAAI,CAAC,GAAD,CAAtB,EAA6BA,IAAI,CAAC,QAAD,CAAjC,CAA1B,CAAP;AACH;;AAED,MAAIA,IAAI,CAACC,cAAL,CAAoB,MAApB,KAA+BD,IAAI,CAACC,cAAL,CAAoB,SAApB,CAAnC,EAAmE;AAC/D,WAAOE,OAAO,CAACC,MAAR,CAAeC,WAAW,CAACP,QAAQ,CAACQ,MAAV,EAAkBN,IAAI,CAAC,MAAD,CAAtB,EAAgCA,IAAI,CAAC,SAAD,CAApC,EAAiDA,IAAI,CAAC,UAAD,CAArD,CAA1B,CAAP;AACH;;AAED,SAAOG,OAAO,CAACC,MAAR,CAAeC,WAAW,CAACP,QAAQ,CAACQ,MAAV,CAA1B,CAAP;AACH,CAlCL;AAqCA,eAAef,QAAf","sourcesContent":["import axios from 'axios';\r\nimport _ from 'lodash';\r\n// import config from './config';\r\n\r\nconst instance = axios.create({\r\n    baseURL: process.env.REACT_APP_BACKEND_URL,\r\n    // withCredentials: true\r\n});\r\n\r\n// const createError = (httpStatusCode, statusCode, errorMessage, problems, errorCode = '') => {\r\n//     const error = new Error();\r\n//     error.httpStatusCode = httpStatusCode;\r\n//     error.statusCode = statusCode;\r\n//     error.errorMessage = errorMessage;\r\n//     error.problems = problems;\r\n//     error.errorCode = errorCode + \"\";\r\n//     return error;\r\n// };\r\n\r\n// export const isSuccessStatusCode = (s) => {\r\n//     // May be string or number\r\n//     const statusType = typeof s;\r\n//     return (statusType === 'number' && s === 0) || (statusType === 'string' && s.toUpperCase() === 'OK');\r\n// };\r\n\r\ninstance.interceptors.response.use(\r\n    (response) => {\r\n        // Thrown error for request with OK status code\r\n        const { data } = response;\r\n        if (data.hasOwnProperty('s') && !isSuccessStatusCode(data['s']) && data.hasOwnProperty('errmsg')) {\r\n            return Promise.reject(createError(response.status, data['s'], data['errmsg'], null, data['errcode'] ? data['errcode'] : \"\"));\r\n        }\r\n        // Return direct data to callback\r\n        if (data.hasOwnProperty('s') && data.hasOwnProperty('d')) {\r\n            return data['d'];\r\n        }\r\n        // Handle special case\r\n        if (data.hasOwnProperty('s') && _.keys(data).length === 1) {\r\n            return null;\r\n        }\r\n        return response.data;\r\n    },\r\n    (error) => {\r\n        const { response } = error;\r\n        if (response == null) {\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        const { data } = response;\r\n\r\n        if (data.hasOwnProperty('s') && data.hasOwnProperty('errmsg')) {\r\n            return Promise.reject(createError(response.status, data['s'], data['errmsg']));\r\n        }\r\n\r\n        if (data.hasOwnProperty('code') && data.hasOwnProperty('message')) {\r\n            return Promise.reject(createError(response.status, data['code'], data['message'], data['problems']));\r\n        }\r\n\r\n        return Promise.reject(createError(response.status));\r\n    }\r\n);\r\n\r\nexport default instance;\r\n"]},"metadata":{},"sourceType":"module"}